externalDeclaration
    : functionDefinition
    | declaration
    ;

functionDefinition
    : declarationSpecifiers declarator declarationList compoundStatement
    | declarationSpecifiers declarator compoundStatement
    | declarator declarationList compoundStatement
    | declarator compoundStatement
    ;

primaryExpression 
    : Identifier
    | Constant
    | ParenthesisOpen expression ParenthesisClose
    ;

postFixExpression  #RECURSIVE OK
    : primaryExpression
    | postFixExpression BracketOpen expression BracketClose
    | postFixExpression ParenthesisOpen ParenthesisClose
    | postFixExpression ParenthesisOpen argumentExpressionList ParenthesisClose 
    | postFixExpression Dot Identifier
    | postFixExpression Accessor Identifier
    | postFixExpression IncOp
    | postFixExpression DecOp
    ;

argumentExpressionList #RECURSIVE OK
    : assignmentExpression
    | argumentExpressionList Comma assignmentExpression
    ;

unaryExpression
    : postFixExpression
    | IncOp unaryExpression
    | DecOp unaryExpression
    | unaryOperator castExpression
    ;

unaryOperator
    : AndOp
    | Product
    | Plus
    | Minus
    | Negate
    | LogicalNot
    ;

castExpression
    : unaryExpression
    ;

multiplicativeExpression #RECURSIVE OK
    : unaryExpression
    | multiplicativeExpression Product unaryExpression
    | multiplicativeExpression Division unaryExpression
    | multiplicativeExpression Module unaryExpression
    ;

additiveExpression #RECURSIVE OK
    : multiplicativeExpression
    | additiveExpression Plus multiplicativeExpression
    | additiveExpression Minus multiplicativeExpression
    ;
 
shiftExpression #RECURSIVE OK
    : additiveExpression
    | shiftExpression LeftOp additiveExpression
    | shiftExpression RightOp additiveExpression
    ;

relationalExpression #RECURSIVE OK
    : shiftExpression
    | relationalExpression Less shiftExpression
    | relationalExpression Greater shiftExpression
    | relationalExpression LEOp shiftExpression
    | relationalExpression GEOP shiftExpression
    ;

equalityExpression #RECURSIVE OK
    : relationalExpression
    | equalityExpression EQOp relationalExpression
    | equalityExpression NEOp relationalExpression
    ;

andExpression #RECURSIVE OK
    : equalityExpression
    | andExpression AndOp equalityExpression
    ;

exclusiveOrExpression #RECURSIVE OK
    : andExpression
    | exclusiveOrExpression Power andExpression
    ;

inclusiveOrExpression #RECURSIVE OK
    : exclusiveOrExpression
    | inclusiveOrExpression OrOp exclusiveOrExpression
    ;

logialAndExpression #RECURSIVE OK
    : inclusiveOrExpression
    | logialAndExpression AndOp inclusiveOrExpression
    ;

logicalOrExpression #RECURSIVE OK
    : logicalAndExpression
    | logicalOrExpression OrOp logicalAndExpression

conditionExpression
    : logicalOrExpression
    | logicalOrExpression QuestionMark expression Colon conditionExpression
    ;

assignmentExpression
    : conditionExpression
    | unaryExpression assignmentOperator assignmentExpression
    ;

assignmentOperator
    : Assign
    | MulAssign
    | DivAssign
    | ModAssign
    | AddAssign
    | LessAssign
    | LeftAssign
    | RightAssign
    ;

expression #RECURSIVE OK
    : assignmentExpression
    | expression Comma assignmentExpression

constantExrpression
    : conditionExpression
    ;

declaration 
    : declarationSpecifiers SemiCollon
    | declarationSpecifiers initDeclaratorList SemiCollon
    ;

declarationSpecifiers
    : typeSpecifier
    | typeSpecifier declarationSpecifiers
    ;

initDeclaratorList #RECURSIVE OK
    : initDeclarator
    | initDeclaratorList Comma initDeclarator
    ;

initDeclarator
    : declarator
    | declarator Assign initializer
    ;

typeSpecifier
    : Void
    | Char
    | Short
    | Int
    | Long
    | Float
    | Double
    | Signed
    | Unsigned
    | structSprecifier
    ;

specifierList
	: typeSpecifier specifierList
	| typeSpecifier
	;

structSprecifier
    : struct Identifier BraceOpen structDeclarationList BraceClose
    | struct BraceOpen structDeclarationList BraceClose
    | struct Identifier
    ;

struct
    : Struct
    ;

structDeclarationList #RECURSIVE OK
    : structDeclarator
    | structDeclarationList Comma structDeclarator
    ;

structDeclarator
    : declarator
    | Collon constantExrpression
    | declarator Collon constantExrpression
    ;

declarator
    : pointer directDeclarator
    | directDeclarator
    ;

directDeclarator #RECURSIVE OK
    : Identifier
    | ParenthesisOpen declarator ParenthesisClose
    | directDeclarator BracketOpen constantExrpression BracketClose
    | directDeclarator BracketOpen BracketClose
    | directDeclarator ParenthesisOpen parameterTypeList ParenthesisClose
    | directDeclarator ParenthesisOpen ParenthesisClose
    ;

pointer 
    : Product
    | Product pointer
    ;

parameterTypeList
    : parameterList
    | parameterList Comma Ellipsis
    ;

parameterList #RECURSIVE OK
    : paramaeterDeclaration
    | parameterList Comma paramaeterDeclaration
    ;

paramaeterDeclaration
    : declarationSpecifiers declarator
    | declarationSpecifiers abstractDeclarator
    | declarationSpecifiers
    ;

identifierList #RECURSIVE OK
    : Identifier
    | identifierList Comma Identifier
    ;

typeName
    : specifierList
    | specifierList abstractDeclarator
    ;

abstractDeclarator
    : pointer
    | directAbstractDeclarator
    | pointer directAbstractDeclarator
    ;

directAbstractDeclarator #RECURSIVE OK
    : ParenthesisOpen abstractDeclarator ParenthesisClose
    | BracketClose BracketClose
    | BracketOpen constantExrpression BracketOpen
    | directAbstractDeclarator BracketOpen BracketClose
    | directAbstractDeclarator BracketOpen conditionExpression BracketClose
    | ParenthesisOpen ParenthesisClose
    | ParenthesisOpen parameterTypeList ParenthesisClose
    | directAbstractDeclarator ParenthesisOpen ParenthesisClose
    | directAbstractDeclarator ParenthesisOpen parameterTypeList ParenthesisClose
    ;

initializer
    : assignmentExpression
    | BraceOpen initializerList BraceClose
    | BraceOpen initializerList Comma BraceClose
    ;

initializerList #RECURSIVE OK
    : initializer
    | initializerList Comma initializer
    ;

statement
    : labeledStatement
    | compoundStatement
    | expressionStatement
    | selectionsStatement
    | iterationStatement
    | jumpStatement
    ;

labeledStatement
    : Identifier Collon statement
    | Case constantExrpression Collon statement
    | Default Collon statement
    ;

compoundStatement
    : BraceOpen BraceClose
    | BraceOpen statementList BraceClose
    | BraceOpen declarationList BraceClose
    | BraceOpen statementList BraceClose

declarationList #RECURSIVE OK
    : declaration
    | declarationList declaration
    ;

statementList #RECURSIVE OK
    : statement
    | statementList statement
    ;

expressionStatement
    : SemiCollon
    | expression SemiCollon
    ;

selectionsStatement
    : If ParenthesisOpen expression ParenthesisClose statement
    | If ParenthesisOpen expression ParenthesisClose statement Else statement
    | Switch ParenthesisOpen expression ParenthesisClose statement
    ;

iterationStatement
    : While ParenthesisOpen expression ParenthesisClose statement
    | Do statement While ParenthesisOpen expression ParenthesisClose SemiCollon
    | For ParenthesisOpen expressionStatement expressionStatement ParenthesisClose statement
    | For ParenthesisOpen expressionStatement expressionStatement expression ParenthesisClose statement
    ;

jumpStatement
    : Continue SemiCollon
    | Break SemiCollon
    | Return SemiCollon
    | Return expression semiCollon
    ;
